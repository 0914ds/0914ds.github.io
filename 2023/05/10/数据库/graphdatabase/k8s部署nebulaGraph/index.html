<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>k8s安装部署nebulaGraph - blog</title><link rel="manifest" href="../../../../../../manifest.json"><meta name="application-name" content="blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="k8s集群安装&amp;amp;nebulaGraph部署 一，集群环境准备  集群规划 1234#把xxx替换为对应的主机名192.168.222.141 node1192.168.222.142 node2192.168.222.143 node3 配置静态ip 1234567# vi &amp;#x2F;etc&amp;#x2F;sysconfig&amp;#x2F;network-scripts&amp;#x2F;ifcfg-enss3#添加如下内容：所有"><meta property="og:type" content="blog"><meta property="og:title" content="k8s安装部署nebulaGraph"><meta property="og:url" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph/"><meta property="og:site_name" content="blog"><meta property="og:description" content="k8s集群安装&amp;amp;nebulaGraph部署 一，集群环境准备  集群规划 1234#把xxx替换为对应的主机名192.168.222.141 node1192.168.222.142 node2192.168.222.143 node3 配置静态ip 1234567# vi &amp;#x2F;etc&amp;#x2F;sysconfig&amp;#x2F;network-scripts&amp;#x2F;ifcfg-enss3#添加如下内容：所有"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220130193936921.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222170808926.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120525765.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120615706.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120657384.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121036160.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121132181.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121419801.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121500369.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121639207.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121800708.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222124826542.png"><meta property="og:image" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222124844668.png"><meta property="article:published_time" content="2023-05-09T18:45:12.000Z"><meta property="article:modified_time" content="2023-06-22T08:28:37.236Z"><meta property="article:author" content="albert dong"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220130193936921.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph/"},"headline":"k8s安装部署nebulaGraph","image":["https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220130193936921.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222170808926.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120525765.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120615706.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120657384.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121036160.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121132181.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121419801.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121500369.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121639207.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121800708.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222124826542.png","https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222124844668.png"],"datePublished":"2023-05-09T18:45:12.000Z","dateModified":"2023-06-22T08:28:37.236Z","author":{"@type":"Person","name":"albert dong"},"publisher":{"@type":"Organization","name":"blog","logo":{"@type":"ImageObject","url":"https://0914ds.github.io/img/logo.svg"}},"description":"k8s集群安装&amp;nebulaGraph部署\r 一，集群环境准备\r \r 集群规划\r 1234#把xxx替换为对应的主机名192.168.222.141 node1192.168.222.142 node2192.168.222.143 node3\r 配置静态ip\r 1234567# vi &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-enss3#添加如下内容：所有"}</script><link rel="canonical" href="https://0914ds.github.io/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph/"><link rel="icon" href="../../../../../../img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="../../../../../../css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="atom.xml" title="blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="../../../../../../index.html"><img src="../../../../../../img/logo.svg" alt="blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="../../../../../../index.html">Home</a><a class="navbar-item" href="../../../../../../archives">Archives</a><a class="navbar-item" href="../../../../../../categories">Categories</a><a class="navbar-item" href="../../../../../../tags">Tags</a><a class="navbar-item" href="../../../../../../about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-05-09T18:45:12.000Z" title="2023/5/10 02:45:12">2023-05-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-06-22T08:28:37.236Z" title="2023/6/22 16:28:37">2023-06-22</time></span><span class="level-item"><a class="link-muted" href="../../../../../../categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">an hour read (About 7040 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">k8s安装部署nebulaGraph</h1><div class="content"><h1 id="k8s集群安装nebulagraph部署">k8s集群安装&amp;nebulaGraph部署</h1>
<h2 id="一集群环境准备">一，集群环境准备</h2>
<ul>
<li><p>集群规划</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#把xxx替换为对应的主机名</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">222.141</span> node1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">222.142</span> node2</span><br><span class="line"><span class="number">192.168</span>.<span class="number">222.143</span> node3</span><br></pre></td></tr></table></figure></li>
<li><p>配置静态ip</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/sysconfig/network-scripts/ifcfg-enss3</span></span><br><span class="line"><span class="comment">#添加如下内容：所有集群都是</span></span><br><span class="line">IPADDR=<span class="string">&quot;192.168.222.XXX&quot;</span></span><br><span class="line">PREFIX=<span class="string">&quot;24&quot;</span></span><br><span class="line">GATEWAY=<span class="string">&quot;192.168.222.x&quot;</span></span><br><span class="line">DNS1=<span class="string">&quot;119.29.29.29&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>配置主机名</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl <span class="built_in">set-hostname</span> xxx</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168</span>.<span class="number">222.141</span> node1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">222.142</span> node2</span><br><span class="line"><span class="number">192.168</span>.<span class="number">222.143</span> node3</span><br></pre></td></tr></table></figure></li>
<li><p>配置ip_forward及过滤机制</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/sysctl.conf</span></span><br><span class="line">net.ipv4.ip_forward = <span class="number">1</span></span><br><span class="line">net.bridge.bridge<span class="literal">-nf-call-ip6tables</span> = <span class="number">1</span></span><br><span class="line">net.bridge.bridge<span class="literal">-nf-call-iptables</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure></li>
<li><p>```powershell modprobe br_netfilter <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* ```powershell</span><br><span class="line">  sysctl -p /etc/sysctl.conf</span><br></pre></td></tr></table></figure></p></li>
<li><p>防火墙</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl stop firewalld</span></span><br><span class="line"><span class="comment"># systemctl disable firewalld</span></span><br></pre></td></tr></table></figure></li>
<li><p>selinux</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">永久关闭，一定要重启操作系统后生效。</span><br><span class="line">sed <span class="literal">-ri</span> <span class="string">&#x27;s/SELINUX=enforcing/SELINUX=disabled/&#x27;</span> /etc/selinux/config</span><br></pre></td></tr></table></figure></li>
<li><p>主机swap分区设置</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="literal">-ri</span> <span class="string">&#x27;s/.*swap.*/#&amp;/&#x27;</span> /etc/fstab</span><br></pre></td></tr></table></figure></li>
<li><p>时间同步</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment"># yum -y install ntpdate</span></span><br><span class="line">  <span class="comment"># crontab -e</span></span><br><span class="line"><span class="number">0</span> */<span class="number">1</span> * * *  ntpdate time1.aliyun.com</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="二docker部署">二、Docker部署</h2>
<blockquote>
<p>所有主机均要配置</p>
</blockquote>
<h3 id="配置docker-yum源">2.1 配置Docker YUM源</h3>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220130193936921.png" alt="image-20220130193936921">
<figcaption aria-hidden="true">image-20220130193936921</figcaption>
</figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget -O /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><br></pre></td></tr></table></figure>
<h3 id="安装docker-ce">2.2 安装Docker CE</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  yum install docker-ce-18.09.8-3.el7.x86_64 -y</span></span><br></pre></td></tr></table></figure>
<h3 id="启动docker服务">2.3 启动Docker服务</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl enable docker</span></span><br><span class="line"><span class="comment"># systemctl start docker</span></span><br></pre></td></tr></table></figure>
<h3 id="配置docker容器镜像加速器">2.4 配置Docker容器镜像加速器</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/docker/daemon.json</span></span><br><span class="line"><span class="comment"># cat /etc/docker/daemon.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://s27w6kze.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三docker-compose安装">三、docker compose安装</h2>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># curl -L &quot;https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chmod +x /usr/local/bin/docker-compose</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker-compose --version</span></span><br></pre></td></tr></table></figure>
<h2 id="四添加rancher用户">四、添加rancher用户</h2>
<blockquote>
<p>使用CentOS时，不能使用 root 账号，因此要添加专用的账号进行 docker相关
操作。</p>
</blockquote>
<blockquote>
<p>所有集群主机均需要操作</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># useradd rancher</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># usermod -aG docker rancher</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># echo 123 | passwd --stdin rancher</span></span><br></pre></td></tr></table></figure>
<h2 id="五生成ssh证书用于部署集群">五、生成ssh证书用于部署集群</h2>
<blockquote>
<p>rke二进制文件安装主机上创建密钥，即为control主机，用于部署集群。</p>
</blockquote>
<h3 id="生成ssh证书">5.1 生成ssh证书</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh-keygen</span></span><br></pre></td></tr></table></figure>
<h3 id="复制证书到集群中所有主机">5.2 复制证书到集群中所有主机</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改文件夹所属用户及所属组</span></span><br><span class="line">chown <span class="literal">-R</span> rancher:rancher /home/rancher</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh-copy-id rancher@master01</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh-copy-id rancher@master02</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh-copy-id rancher@worker01</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh-copy-id rancher@worker02</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh-copy-id rancher@etcd01</span></span><br></pre></td></tr></table></figure>
<h3 id="验证ssh证书是否可用">5.3 验证ssh证书是否可用</h3>
<blockquote>
<p>本次在master01上部署rke二进制文件。</p>
</blockquote>
<blockquote>
<p>在rke二进制文件安装主机机测试连接其它集群主机，验证是否可使用docker
ps命令即可。</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh rancher@主机名</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">远程主机<span class="comment"># docker ps</span></span><br></pre></td></tr></table></figure>
<h2 id="六rke工具下载">六、rke工具下载</h2>
<blockquote>
<p>本次在master01上部署rke二进制文件。</p>
</blockquote>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222170808926.png" alt="image-20220222170808926">
<figcaption aria-hidden="true">image-20220222170808926</figcaption>
</figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget https://github.com/rancher/rke/releases/download/v1.3.7/rke_linux-amd64</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mv rke_linux-amd64 /usr/local/bin/rke</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chmod +x /usr/local/bin/rke</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rke --version</span></span><br><span class="line">rke version v1.<span class="number">3.7</span></span><br></pre></td></tr></table></figure>
<h2 id="七初始化rke配置文件">七、初始化rke配置文件</h2>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir -p /app/rancher</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /app/rancher</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rke config --name cluster.yml</span></span><br><span class="line">[+] Cluster Level SSH Private Key Path [~/<span class="type">.ssh</span>/<span class="type">id_rsa</span>]: 集群私钥路径</span><br><span class="line">[+] Number of Hosts [<span class="number">1</span>]: <span class="number">3</span> 集群中有<span class="number">3</span>个节点</span><br><span class="line">[+] SSH Address of host (<span class="number">1</span>) [<span class="type">none</span>]: <span class="number">192.168</span>.<span class="number">10.10</span> 第一个节点IP地址</span><br><span class="line">[+] SSH Port of host (<span class="number">1</span>) [<span class="number">22</span>]: <span class="number">22</span> 第一个节点SSH访问端口</span><br><span class="line">[+] SSH Private Key Path of host (<span class="number">192.168</span>.<span class="number">10.10</span>) [<span class="type">none</span>]: ~/.ssh/id_rsa 第一个节点私钥路径</span><br><span class="line">[+] SSH User of host (<span class="number">192.168</span>.<span class="number">10.10</span>) [<span class="type">ubuntu</span>]: rancher 远程用户名</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.10</span>) a Control Plane host (y/n)? [<span class="type">y</span>]: y 是否为k8s集群控制节点</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.10</span>) a Worker host (y/n)? [<span class="type">n</span>]: n 不是worker节点</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.10</span>) an etcd host (y/n)? [<span class="type">n</span>]: n 不是etcd节点</span><br><span class="line">[+] Override Hostname of host (<span class="number">192.168</span>.<span class="number">10.10</span>) [<span class="type">none</span>]: 不覆盖现有主机名</span><br><span class="line">[+] Internal IP of host (<span class="number">192.168</span>.<span class="number">10.10</span>) [<span class="type">none</span>]: 主机局域网IP地址</span><br><span class="line">[+] Docker socket path on host (<span class="number">192.168</span>.<span class="number">10.10</span>) [/<span class="type">var</span>/<span class="type">run</span>/<span class="type">docker.sock</span>]: 主机上docker.sock路径</span><br><span class="line">[+] SSH Address of host (<span class="number">2</span>) [<span class="type">none</span>]: <span class="number">192.168</span>.<span class="number">10.12</span> 第二个节点</span><br><span class="line">[+] SSH Port of host (<span class="number">2</span>) [<span class="number">22</span>]: <span class="number">22</span> 远程端口</span><br><span class="line">[+] SSH Private Key Path of host (<span class="number">192.168</span>.<span class="number">10.12</span>) [<span class="type">none</span>]: ~/.ssh/id_rsa 私钥路径</span><br><span class="line">[+] SSH User of host (<span class="number">192.168</span>.<span class="number">10.12</span>) [<span class="type">ubuntu</span>]: rancher 远程访问用户</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.12</span>) a Control Plane host (y/n)? [<span class="type">y</span>]: n 不是控制节点</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.12</span>) a Worker host (y/n)? [<span class="type">n</span>]: y 是worker节点</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.12</span>) an etcd host (y/n)? [<span class="type">n</span>]: n 不是etcd节点</span><br><span class="line">[+] Override Hostname of host (<span class="number">192.168</span>.<span class="number">10.12</span>) [<span class="type">none</span>]: 不覆盖现有主机名</span><br><span class="line">[+] Internal IP of host (<span class="number">192.168</span>.<span class="number">10.12</span>) [<span class="type">none</span>]: 主机局域网IP地址</span><br><span class="line">[+] Docker socket path on host (<span class="number">192.168</span>.<span class="number">10.12</span>) [/<span class="type">var</span>/<span class="type">run</span>/<span class="type">docker.sock</span>]: 主机上docker.sock路径</span><br><span class="line">[+] SSH Address of host (<span class="number">3</span>) [<span class="type">none</span>]: <span class="number">192.168</span>.<span class="number">10.14</span> 第三个节点</span><br><span class="line">[+] SSH Port of host (<span class="number">3</span>) [<span class="number">22</span>]: <span class="number">22</span> 远程端口</span><br><span class="line">[+] SSH Private Key Path of host (<span class="number">192.168</span>.<span class="number">10.14</span>) [<span class="type">none</span>]: ~/.ssh/id_rsa 私钥路径</span><br><span class="line">[+] SSH User of host (<span class="number">192.168</span>.<span class="number">10.14</span>) [<span class="type">ubuntu</span>]: rancher 远程访问用户</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.14</span>) a Control Plane host (y/n)? [<span class="type">y</span>]: n 不是控制节点</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.14</span>) a Worker host (y/n)? [<span class="type">n</span>]: n 不是worker节点</span><br><span class="line">[+] Is host (<span class="number">192.168</span>.<span class="number">10.14</span>) an etcd host (y/n)? [<span class="type">n</span>]: y 是etcd节点</span><br><span class="line">[+] Override Hostname of host (<span class="number">192.168</span>.<span class="number">10.14</span>) [<span class="type">none</span>]: 不覆盖现有主机名</span><br><span class="line">[+] Internal IP of host (<span class="number">192.168</span>.<span class="number">10.14</span>) [<span class="type">none</span>]: 主机局域网IP地址</span><br><span class="line">[+] Docker socket path on host (<span class="number">192.168</span>.<span class="number">10.14</span>) [/<span class="type">var</span>/<span class="type">run</span>/<span class="type">docker.sock</span>]: 主机上docker.sock路径</span><br><span class="line">[+] Network Plugin <span class="built_in">Type</span> (flannel, calico, weave, canal, aci) [<span class="type">canal</span>]: 使用的网络插件</span><br><span class="line">[+] Authentication Strategy [<span class="type">x509</span>]: 认证策略</span><br><span class="line">[+] Authorization Mode (rbac, none) [<span class="type">rbac</span>]: 认证模式</span><br><span class="line">[+] Kubernetes Docker image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>]: 集群容器镜像</span><br><span class="line">[+] Cluster domain [<span class="type">cluster.local</span>]: 集群域名</span><br><span class="line">[+] Service Cluster IP Range [<span class="number">10.43</span><span class="type">.0.0</span>/<span class="number">16</span>]: 集群中Servic IP地址范围</span><br><span class="line">[+] Enable PodSecurityPolicy [<span class="type">n</span>]: 是否开启Pod安装策略</span><br><span class="line">[+] Cluster Network CIDR [<span class="number">10.42</span><span class="type">.0.0</span>/<span class="number">16</span>]: 集群Pod网络</span><br><span class="line">[+] Cluster DNS Service IP [<span class="number">10.43</span><span class="type">.0.10</span>]: 集群DNS Service IP地址</span><br><span class="line">[+] Add addon manifest URLs or YAML files [<span class="type">no</span>]: 是否增加插件manifest URL或配置文件</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> <span class="type">rancher</span>]<span class="comment"># ls</span></span><br><span class="line">cluster.yml</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在cluster.yaml文件中</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kube<span class="literal">-controller</span>:</span><br><span class="line">image: <span class="string">&quot;&quot;</span></span><br><span class="line">extra_args:</span><br><span class="line"><span class="comment"># 如果后面需要部署kubeflow或istio则一定要配置以下参数</span></span><br><span class="line">cluster<span class="literal">-signing-cert-file</span>: <span class="string">&quot;/etc/kubernetes/ssl/kube-ca.pem&quot;</span></span><br><span class="line">cluster<span class="literal">-signing-key-file</span>: <span class="string">&quot;/etc/kubernetes/ssl/kube-ca-key.pem&quot;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="八集群部署">八、集群部署</h2>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/app/rancher</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rke up</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br></pre></td><td class="code"><pre><span class="line">输出：</span><br><span class="line">INFO[<span class="number">0000</span>] Running RKE version: v1.<span class="number">3.7</span></span><br><span class="line">INFO[<span class="number">0000</span>] Initiating Kubernetes cluster</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">dialer</span>] Setup tunnel <span class="keyword">for</span> host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">dialer</span>] Setup tunnel <span class="keyword">for</span> host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">dialer</span>] Setup tunnel <span class="keyword">for</span> host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0000</span>] Checking <span class="keyword">if</span> container [<span class="type">cluster</span>-<span class="type">state</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0000</span>] Checking <span class="keyword">if</span> container [<span class="type">cluster</span>-<span class="type">state</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0000</span>] Checking <span class="keyword">if</span> container [<span class="type">cluster</span>-<span class="type">state</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating CA kubernetes certificates</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating Kubernetes API server aggregation layer requestheader client CA certificates</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] GenerateServingCertificate is disabled, checking <span class="keyword">if</span> there are unused kubelet certificates</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating Kubernetes API server certificates</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating Service account token key</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating Kube Controller certificates</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating Kube Scheduler certificates</span><br><span class="line">INFO[<span class="number">0000</span>] [<span class="type">certificates</span>] Generating Kube Proxy certificates</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">certificates</span>] Generating Node certificate</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">certificates</span>] Generating admin certificates and kubeconfig</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">certificates</span>] Generating Kubernetes API server proxy client certificates</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">certificates</span>] Generating kube<span class="literal">-etcd-192-168-10-14</span> certificate and key</span><br><span class="line">INFO[<span class="number">0001</span>] Successfully Deployed state file at [<span class="type">.</span>/<span class="type">cluster.rkestate</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] Building Kubernetes cluster</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">dialer</span>] Setup tunnel <span class="keyword">for</span> host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">dialer</span>] Setup tunnel <span class="keyword">for</span> host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">dialer</span>] Setup tunnel <span class="keyword">for</span> host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">network</span>] Deploying port listener containers</span><br><span class="line">INFO[<span class="number">0001</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] Starting container [<span class="type">rke</span>-<span class="type">etcd</span>-<span class="type">port</span>-<span class="type">listener</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0001</span>] [<span class="type">network</span>] Successfully started [<span class="type">rke</span>-<span class="type">etcd</span>-<span class="type">port</span>-<span class="type">listener</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0001</span>] Starting container [<span class="type">rke</span>-<span class="type">cp</span>-<span class="type">port</span>-<span class="type">listener</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Successfully started [<span class="type">rke</span>-<span class="type">cp</span>-<span class="type">port</span>-<span class="type">listener</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0002</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0002</span>] Starting container [<span class="type">rke</span>-<span class="type">worker</span>-<span class="type">port</span>-<span class="type">listener</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Successfully started [<span class="type">rke</span>-<span class="type">worker</span>-<span class="type">port</span>-<span class="type">listener</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Port listener containers deployed successfully</span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Running control plane -&gt; etcd port checks</span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Checking <span class="keyword">if</span> host [<span class="number">192.168</span><span class="type">.10.10</span>] can connect to host(s) [<span class="number">192.168</span><span class="type">.10.14</span>] on port(s) [<span class="number">2379</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0002</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0002</span>] Starting container [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Successfully started [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0002</span>] Removing container [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Running control plane -&gt; worker port checks</span><br><span class="line">INFO[<span class="number">0002</span>] [<span class="type">network</span>] Checking <span class="keyword">if</span> host [<span class="number">192.168</span><span class="type">.10.10</span>] can connect to host(s) [<span class="number">192.168</span><span class="type">.10.12</span>] on port(s) [<span class="number">10250</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0002</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Starting container [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Successfully started [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Removing container [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Running workers -&gt; control plane port checks</span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Checking <span class="keyword">if</span> host [<span class="number">192.168</span><span class="type">.10.12</span>] can connect to host(s) [<span class="number">192.168</span><span class="type">.10.10</span>] on port(s) [<span class="number">6443</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Starting container [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Successfully started [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Removing container [<span class="type">rke</span>-<span class="type">port</span>-<span class="type">checker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Checking KubeAPI port Control Plane hosts</span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Removing port listener containers</span><br><span class="line">INFO[<span class="number">0003</span>] Removing container [<span class="type">rke</span>-<span class="type">etcd</span>-<span class="type">port</span>-<span class="type">listener</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">etcd</span>-<span class="type">port</span>-<span class="type">listener</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Removing container [<span class="type">rke</span>-<span class="type">cp</span>-<span class="type">port</span>-<span class="type">listener</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">cp</span>-<span class="type">port</span>-<span class="type">listener</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Removing container [<span class="type">rke</span>-<span class="type">worker</span>-<span class="type">port</span>-<span class="type">listener</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">worker</span>-<span class="type">port</span>-<span class="type">listener</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">network</span>] Port listener containers removed successfully</span><br><span class="line">INFO[<span class="number">0003</span>] [<span class="type">certificates</span>] Deploying kubernetes certificates to Cluster nodes</span><br><span class="line">INFO[<span class="number">0003</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0003</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0003</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0004</span>] Starting container [<span class="type">cert</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0004</span>] Starting container [<span class="type">cert</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0004</span>] Starting container [<span class="type">cert</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0004</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0004</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0004</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Removing container [<span class="type">cert</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Removing container [<span class="type">cert</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Checking <span class="keyword">if</span> container [<span class="type">cert</span>-<span class="type">deployer</span>] is running on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Removing container [<span class="type">cert</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] [<span class="type">reconcile</span>] Rebuilding and updating local kube config</span><br><span class="line">INFO[<span class="number">0009</span>] Successfully Deployed local admin kubeconfig at [<span class="type">.</span>/<span class="type">kube_config_cluster.yml</span>]</span><br><span class="line">WARN[<span class="number">0009</span>] [<span class="type">reconcile</span>] host [<span class="number">192.168</span><span class="type">.10.10</span>] is a control plane node without reachable Kubernetes API endpoint <span class="keyword">in</span> the cluster</span><br><span class="line">WARN[<span class="number">0009</span>] [<span class="type">reconcile</span>] no control plane node with reachable Kubernetes API endpoint <span class="keyword">in</span> the cluster found</span><br><span class="line">INFO[<span class="number">0009</span>] [<span class="type">certificates</span>] Successfully deployed kubernetes certificates to Cluster nodes</span><br><span class="line">INFO[<span class="number">0009</span>] [<span class="type">file</span>-<span class="type">deploy</span>] Deploying file [/<span class="type">etc</span>/<span class="type">kubernetes</span>/<span class="type">audit</span>-<span class="type">policy.yaml</span>] to node [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0009</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0009</span>] Starting container [<span class="type">file</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0009</span>] Successfully started [<span class="type">file</span>-<span class="type">deployer</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0009</span>] Waiting <span class="keyword">for</span> [<span class="type">file</span>-<span class="type">deployer</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0009</span>] Waiting <span class="keyword">for</span> [<span class="type">file</span>-<span class="type">deployer</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0009</span>] Container [<span class="type">file</span>-<span class="type">deployer</span>] is still running on host [<span class="number">192.168</span><span class="type">.10.10</span>]: stderr: [], stdout: []</span><br><span class="line">INFO[<span class="number">0010</span>] Waiting <span class="keyword">for</span> [<span class="type">file</span>-<span class="type">deployer</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0010</span>] Removing container [<span class="type">file</span>-<span class="type">deployer</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0010</span>] [<span class="type">remove</span>/<span class="type">file</span>-<span class="type">deployer</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0010</span>] [/<span class="type">etc</span>/<span class="type">kubernetes</span>/<span class="type">audit</span>-<span class="type">policy.yaml</span>] Successfully deployed audit policy file to Cluster control nodes</span><br><span class="line">INFO[<span class="number">0010</span>] [<span class="type">reconcile</span>] Reconciling cluster state</span><br><span class="line">INFO[<span class="number">0010</span>] [<span class="type">reconcile</span>] This is newly generated cluster</span><br><span class="line">INFO[<span class="number">0010</span>] Pre<span class="literal">-pulling</span> kubernetes images</span><br><span class="line">INFO[<span class="number">0010</span>] Pulling image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0010</span>] Pulling image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0010</span>] Pulling image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0087</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0090</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0092</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0092</span>] Kubernetes images pulled successfully</span><br><span class="line">INFO[<span class="number">0092</span>] [<span class="type">etcd</span>] Building up etcd plane..</span><br><span class="line">INFO[<span class="number">0092</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0092</span>] Starting container [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0092</span>] Successfully started [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0092</span>] Waiting <span class="keyword">for</span> [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0092</span>] Waiting <span class="keyword">for</span> [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0092</span>] Container [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] is still running on host [<span class="number">192.168</span><span class="type">.10.14</span>]: stderr: [], stdout: []</span><br><span class="line">INFO[<span class="number">0093</span>] Waiting <span class="keyword">for</span> [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0093</span>] Removing container [<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0093</span>] [<span class="type">remove</span>/<span class="type">etcd</span>-<span class="type">fix</span>-<span class="type">perm</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0093</span>] Image [<span class="type">rancher</span>/<span class="type">mirrored</span>-<span class="type">coreos</span>-<span class="type">etcd</span>:<span class="type">v3.5.0</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0093</span>] Starting container [<span class="type">etcd</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0093</span>] [<span class="type">etcd</span>] Successfully started [<span class="type">etcd</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0093</span>] [<span class="type">etcd</span>] Running rolling snapshot container [<span class="type">etcd</span>-<span class="type">snapshot</span>-<span class="type">once</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0093</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0094</span>] Starting container [<span class="type">etcd</span>-<span class="type">rolling</span>-<span class="type">snapshots</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0094</span>] [<span class="type">etcd</span>] Successfully started [<span class="type">etcd</span>-<span class="type">rolling</span>-<span class="type">snapshots</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0099</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0099</span>] Starting container [<span class="type">rke</span>-<span class="type">bundle</span>-<span class="type">cert</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0099</span>] [<span class="type">certificates</span>] Successfully started [<span class="type">rke</span>-<span class="type">bundle</span>-<span class="type">cert</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0099</span>] Waiting <span class="keyword">for</span> [<span class="type">rke</span>-<span class="type">bundle</span>-<span class="type">cert</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0099</span>] Container [<span class="type">rke</span>-<span class="type">bundle</span>-<span class="type">cert</span>] is still running on host [<span class="number">192.168</span><span class="type">.10.14</span>]: stderr: [], stdout: []</span><br><span class="line">INFO[<span class="number">0100</span>] Waiting <span class="keyword">for</span> [<span class="type">rke</span>-<span class="type">bundle</span>-<span class="type">cert</span>] container to <span class="keyword">exit</span> on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0100</span>] [<span class="type">certificates</span>] successfully saved certificate bundle [/<span class="type">opt</span>/<span class="type">rke</span>/<span class="type">etcd</span>-<span class="type">snapshots</span>//<span class="type">pki.bundle.tar.gz</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0100</span>] Removing container [<span class="type">rke</span>-<span class="type">bundle</span>-<span class="type">cert</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0100</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0100</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0100</span>] [<span class="type">etcd</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0100</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0100</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0100</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0101</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">etcd</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0101</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">etcd</span>] Successfully started etcd plane.. Checking etcd cluster health</span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">etcd</span>] etcd host [<span class="number">192.168</span><span class="type">.10.14</span>] reported healthy=true</span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">controlplane</span>] Building up Controller Plane..</span><br><span class="line">INFO[<span class="number">0101</span>] Checking <span class="keyword">if</span> container [<span class="type">service</span>-<span class="type">sidekick</span>] is running on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0101</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0101</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0101</span>] Starting container [<span class="type">kube</span>-<span class="type">apiserver</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">controlplane</span>] Successfully started [<span class="type">kube</span>-<span class="type">apiserver</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0101</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kube</span>-<span class="type">apiserver</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0106</span>] [<span class="type">healthcheck</span>] service [<span class="type">kube</span>-<span class="type">apiserver</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>] is healthy</span><br><span class="line">INFO[<span class="number">0106</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0107</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0107</span>] [<span class="type">controlplane</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0107</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0107</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0107</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0107</span>] Starting container [<span class="type">kube</span>-<span class="type">controller</span>-<span class="type">manager</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0107</span>] [<span class="type">controlplane</span>] Successfully started [<span class="type">kube</span>-<span class="type">controller</span>-<span class="type">manager</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0107</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kube</span>-<span class="type">controller</span>-<span class="type">manager</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0112</span>] [<span class="type">healthcheck</span>] service [<span class="type">kube</span>-<span class="type">controller</span>-<span class="type">manager</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>] is healthy</span><br><span class="line">INFO[<span class="number">0112</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0113</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0113</span>] [<span class="type">controlplane</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0113</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0113</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0113</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0113</span>] Starting container [<span class="type">kube</span>-<span class="type">scheduler</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0113</span>] [<span class="type">controlplane</span>] Successfully started [<span class="type">kube</span>-<span class="type">scheduler</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0113</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kube</span>-<span class="type">scheduler</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0118</span>] [<span class="type">healthcheck</span>] service [<span class="type">kube</span>-<span class="type">scheduler</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>] is healthy</span><br><span class="line">INFO[<span class="number">0118</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">controlplane</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">controlplane</span>] Successfully started Controller Plane..</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">authz</span>] Creating rke<span class="literal">-job-deployer</span> ServiceAccount</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">authz</span>] rke<span class="literal">-job-deployer</span> ServiceAccount created successfully</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">authz</span>] Creating system:node ClusterRoleBinding</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">authz</span>] system:node ClusterRoleBinding created successfully</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">authz</span>] Creating kube<span class="literal">-apiserver</span> proxy ClusterRole and ClusterRoleBinding</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">authz</span>] kube<span class="literal">-apiserver</span> proxy ClusterRole and ClusterRoleBinding created successfully</span><br><span class="line">INFO[<span class="number">0119</span>] Successfully Deployed state file at [<span class="type">.</span>/<span class="type">cluster.rkestate</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">state</span>] Saving full cluster state to Kubernetes</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">state</span>] Successfully Saved full cluster state to Kubernetes ConfigMap: full<span class="literal">-cluster-state</span></span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">worker</span>] Building up Worker Plane..</span><br><span class="line">INFO[<span class="number">0119</span>] Checking <span class="keyword">if</span> container [<span class="type">service</span>-<span class="type">sidekick</span>] is running on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0119</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">sidekick</span>] Sidekick container already created on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Starting container [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">worker</span>] Successfully started [<span class="type">kubelet</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Starting container [<span class="type">nginx</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">worker</span>] Successfully started [<span class="type">nginx</span>-<span class="type">proxy</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Starting container [<span class="type">nginx</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0119</span>] [<span class="type">worker</span>] Successfully started [<span class="type">nginx</span>-<span class="type">proxy</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0119</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Checking <span class="keyword">if</span> container [<span class="type">service</span>-<span class="type">sidekick</span>] is running on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Checking <span class="keyword">if</span> container [<span class="type">service</span>-<span class="type">sidekick</span>] is running on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Starting container [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">worker</span>] Successfully started [<span class="type">kubelet</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] Starting container [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">worker</span>] Successfully started [<span class="type">kubelet</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0120</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0124</span>] [<span class="type">healthcheck</span>] service [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>] is healthy</span><br><span class="line">INFO[<span class="number">0124</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0124</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] Starting container [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">worker</span>] Successfully started [<span class="type">kube</span>-<span class="type">proxy</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">healthcheck</span>] service [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>] is healthy</span><br><span class="line">INFO[<span class="number">0125</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">healthcheck</span>] service [<span class="type">kubelet</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>] is healthy</span><br><span class="line">INFO[<span class="number">0125</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0125</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0125</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] Starting container [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">worker</span>] Successfully started [<span class="type">kube</span>-<span class="type">proxy</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] Image [<span class="type">rancher</span>/<span class="type">hyperkube</span>:<span class="type">v1.21.9</span>-<span class="type">rancher1</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] Starting container [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">worker</span>] Successfully started [<span class="type">kube</span>-<span class="type">proxy</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0126</span>] [<span class="type">healthcheck</span>] <span class="built_in">Start</span> Healthcheck on service [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0130</span>] [<span class="type">healthcheck</span>] service [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>] is healthy</span><br><span class="line">INFO[<span class="number">0130</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0130</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0130</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0130</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0130</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">healthcheck</span>] service [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>] is healthy</span><br><span class="line">INFO[<span class="number">0131</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">healthcheck</span>] service [<span class="type">kube</span>-<span class="type">proxy</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>] is healthy</span><br><span class="line">INFO[<span class="number">0131</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0131</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">worker</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">linker</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] [<span class="type">worker</span>] Successfully started Worker Plane..</span><br><span class="line">INFO[<span class="number">0131</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0131</span>] Image [<span class="type">rancher</span>/<span class="type">rke</span>-<span class="type">tools</span>:<span class="type">v0.1.78</span>] exists on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0132</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0132</span>] Starting container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">cleanup</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] on host [<span class="number">192.168</span><span class="type">.10.14</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">cleanup</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] on host [<span class="number">192.168</span><span class="type">.10.12</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">cleanup</span>] Successfully started [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] Removing container [<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] on host [<span class="number">192.168</span><span class="type">.10.10</span>], <span class="keyword">try</span> <span class="comment">#1</span></span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.14</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.12</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">remove</span>/<span class="type">rke</span>-<span class="type">log</span>-<span class="type">cleaner</span>] Successfully removed container on host [<span class="number">192.168</span><span class="type">.10.10</span>]</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">sync</span>] Syncing nodes Labels and Taints</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">sync</span>] Successfully synced nodes Labels and Taints</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">network</span>] Setting up network plugin: canal</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">addons</span>] Saving ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-network-plugin</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">addons</span>] Successfully saved ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-network-plugin</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0132</span>] [<span class="type">addons</span>] Executing deploy job rke<span class="literal">-network-plugin</span></span><br><span class="line">INFO[<span class="number">0137</span>] [<span class="type">addons</span>] Setting up coredns</span><br><span class="line">INFO[<span class="number">0137</span>] [<span class="type">addons</span>] Saving ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-coredns-addon</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0137</span>] [<span class="type">addons</span>] Successfully saved ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-coredns-addon</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0137</span>] [<span class="type">addons</span>] Executing deploy job rke<span class="literal">-coredns-addon</span></span><br><span class="line">INFO[<span class="number">0142</span>] [<span class="type">addons</span>] CoreDNS deployed successfully</span><br><span class="line">INFO[<span class="number">0142</span>] [<span class="type">dns</span>] DNS provider coredns deployed successfully</span><br><span class="line">INFO[<span class="number">0142</span>] [<span class="type">addons</span>] Setting up Metrics Server</span><br><span class="line">INFO[<span class="number">0142</span>] [<span class="type">addons</span>] Saving ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-metrics-addon</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0142</span>] [<span class="type">addons</span>] Successfully saved ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-metrics-addon</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0142</span>] [<span class="type">addons</span>] Executing deploy job rke<span class="literal">-metrics-addon</span></span><br><span class="line">INFO[<span class="number">0147</span>] [<span class="type">addons</span>] Metrics Server deployed successfully</span><br><span class="line">INFO[<span class="number">0147</span>] [<span class="type">ingress</span>] Setting up nginx ingress controller</span><br><span class="line">INFO[<span class="number">0147</span>] [<span class="type">ingress</span>] removing admission batch jobs <span class="keyword">if</span> they exist</span><br><span class="line">INFO[<span class="number">0147</span>] [<span class="type">addons</span>] Saving ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-ingress-controller</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0147</span>] [<span class="type">addons</span>] Successfully saved ConfigMap <span class="keyword">for</span> addon rke<span class="literal">-ingress-controller</span> to Kubernetes</span><br><span class="line">INFO[<span class="number">0147</span>] [<span class="type">addons</span>] Executing deploy job rke<span class="literal">-ingress-controller</span></span><br><span class="line">INFO[<span class="number">0152</span>] [<span class="type">ingress</span>] removing default backend service and deployment <span class="keyword">if</span> they exist</span><br><span class="line">INFO[<span class="number">0152</span>] [<span class="type">ingress</span>] ingress controller nginx deployed successfully</span><br><span class="line">INFO[<span class="number">0152</span>] [<span class="type">addons</span>] Setting up user addons</span><br><span class="line">INFO[<span class="number">0152</span>] [<span class="type">addons</span>] no user addons defined</span><br><span class="line">INFO[<span class="number">0152</span>] Finished building Kubernetes cluster successfully</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果部署失败，报错：</p>
<p>WARN[0114] [etcd] host [xxxxxxx] failed to check etcd health: failed
to get /health for host [xxxxxxx]: Get "https://xxxxxxxx:2379/health":
remote error: tls: bad certificate FATA[0114] [etcd] Failed to bring up
Etcd Plane: etcd cluster is unhealthy: hosts [xxxxxxxx] failed to report
healthy. Check etcd container logs on each host for more information</p>
<p>所有节点执行（无法删除就重启机器）：rm -rf /etc/kubernetes/
/var/lib/kubelet/ /var/lib/etcd/</p>
</blockquote>
<h2 id="九安装kubectl客户端">九、安装kubectl客户端</h2>
<blockquote>
<p>在master01主机上操作。</p>
</blockquote>
<h3 id="kubectl客户端安装">9.1 kubectl客户端安装</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget https://storage.googleapis.com/kubernetes-release/release/v1.21.9/bin/linux/amd64/kubectl</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chmod +x kubectl </span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mv kubectl /usr/local/bin/kubectl</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># kubectl version --client</span></span><br><span class="line">Client Version: version.Info&#123;Major:<span class="string">&quot;1&quot;</span>, Minor:<span class="string">&quot;21&quot;</span>, GitVersion:<span class="string">&quot;v1.21.9&quot;</span>, GitCommit:<span class="string">&quot;f59f5c2fda36e4036b49ec027e556a15456108f0&quot;</span>, GitTreeState:<span class="string">&quot;clean&quot;</span>, BuildDate:<span class="string">&quot;2022-01-19T17:33:06Z&quot;</span>, GoVersion:<span class="string">&quot;go1.16.12&quot;</span>, Compiler:<span class="string">&quot;gc&quot;</span>, Platform:<span class="string">&quot;linux/amd64&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="kubectl客户端配置集群管理文件及应用验证">9.2
kubectl客户端配置集群管理文件及应用验证</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># ls /app/rancher/</span></span><br><span class="line">cluster.rkestate  cluster.yml  kube_config_cluster.yml</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># mkdir ./.kube</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># cp /app/rancher/kube_config_cluster.yml /root/.kube/config</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># kubectl get nodes</span></span><br><span class="line">NAME            STATUS   ROLES          AGE     VERSION</span><br><span class="line"><span class="number">192.168</span>.<span class="number">10.10</span>   Ready    controlplane   <span class="number">9</span>m13s   v1.<span class="number">21.9</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">10.12</span>   Ready    worker         <span class="number">9</span>m12s   v1.<span class="number">21.9</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">10.14</span>   Ready    etcd           <span class="number">9</span>m12s   v1.<span class="number">21.9</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># kubectl get pods -n kube-system</span></span><br><span class="line">NAME                                         READY   STATUS      RESTARTS   AGE</span><br><span class="line">calico<span class="literal">-kube-controllers-5685fbd9f7-gcwj7</span>     <span class="number">1</span>/<span class="number">1</span>     Running     <span class="number">0</span>          <span class="number">9</span>m36s</span><br><span class="line">canal<span class="literal">-fz2bg</span>                                  <span class="number">2</span>/<span class="number">2</span>     Running     <span class="number">0</span>          <span class="number">9</span>m36s</span><br><span class="line">canal<span class="literal">-qzw4n</span>                                  <span class="number">2</span>/<span class="number">2</span>     Running     <span class="number">0</span>          <span class="number">9</span>m36s</span><br><span class="line">canal<span class="literal">-sstjn</span>                                  <span class="number">2</span>/<span class="number">2</span>     Running     <span class="number">0</span>          <span class="number">9</span>m36s</span><br><span class="line">coredns<span class="literal">-8578b6dbdd-ftnf6</span>                     <span class="number">1</span>/<span class="number">1</span>     Running     <span class="number">0</span>          <span class="number">9</span>m30s</span><br><span class="line">coredns<span class="literal">-autoscaler-f7b68ccb7-fzdgc</span>           <span class="number">1</span>/<span class="number">1</span>     Running     <span class="number">0</span>          <span class="number">9</span>m30s</span><br><span class="line">metrics<span class="literal">-server-6bc7854fb5-kwppz</span>              <span class="number">1</span>/<span class="number">1</span>     Running     <span class="number">0</span>          <span class="number">9</span>m25s</span><br><span class="line">rke<span class="literal">-coredns-addon-deploy-job--1-x56w2</span>        <span class="number">0</span>/<span class="number">1</span>     Completed   <span class="number">0</span>          <span class="number">9</span>m31s</span><br><span class="line">rke<span class="literal">-ingress-controller-deploy-job--1-wzp2b</span>   <span class="number">0</span>/<span class="number">1</span>     Completed   <span class="number">0</span>          <span class="number">9</span>m21s</span><br><span class="line">rke<span class="literal">-metrics-addon-deploy-job--1-ltlgn</span>        <span class="number">0</span>/<span class="number">1</span>     Completed   <span class="number">0</span>          <span class="number">9</span>m26s</span><br><span class="line">rke<span class="literal">-network-plugin-deploy-job--1-nsbfn</span>       <span class="number">0</span>/<span class="number">1</span>     Completed   <span class="number">0</span>          <span class="number">9</span>m41s</span><br></pre></td></tr></table></figure>
<h2 id="十集群web管理-rancher">十、集群web管理 rancher</h2>
<blockquote>
<p>在master01运行</p>
</blockquote>
<p>rancher控制面板主要方便用于控制k8s集群，查看集群状态，编辑集群等。</p>
<h3 id="使用docker-run启动一个rancher">10.1，使用docker
run启动一个rancher</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意映射端口改了</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># docker run -d --restart=unless-stopped --privileged --name rancher -p 1080:80 -p 1443:443 rancher/rancher:v2.5.9</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID   IMAGE                                COMMAND                  CREATED          STATUS          PORTS                                                                      NAMES</span><br><span class="line"><span class="number">0</span>fd46ee77655   rancher/rancher:v2.<span class="number">5.9</span>               <span class="string">&quot;entrypoint.sh&quot;</span>          <span class="number">5</span> seconds ago    Up <span class="number">3</span> seconds    <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>-&gt;<span class="number">80</span>/tcp, :::<span class="number">80</span>-&gt;<span class="number">80</span>/tcp, <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">443</span>-&gt;<span class="number">443</span>/tcp, :::<span class="number">443</span>-&gt;<span class="number">443</span>/tcp   rancher</span><br></pre></td></tr></table></figure>
<h3 id="访问rancher这里映射端口10801443">10.2
访问rancher【这里映射端口1080，1443】</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># ss -anput | grep &quot;:1080&quot;</span></span><br><span class="line">tcp    LISTEN     <span class="number">0</span>      <span class="number">128</span>       *:<span class="number">1080</span>                    *:*                   users:((<span class="string">&quot;docker-proxy&quot;</span>,pid=<span class="number">29564</span>,fd=<span class="number">4</span>))</span><br><span class="line">tcp    LISTEN     <span class="number">0</span>      <span class="number">128</span>    [::]:<span class="number">1080</span>                 [::]:*                   users:((<span class="string">&quot;docker-proxy&quot;</span>,pid=<span class="number">29570</span>,fd=<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120525765.png" alt="image-20220222120525765">
<figcaption aria-hidden="true">image-20220222120525765</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120615706.png" alt="image-20220222120615706">
<figcaption aria-hidden="true">image-20220222120615706</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222120657384.png" alt="image-20220222120657384">
<figcaption aria-hidden="true">image-20220222120657384</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121036160.png" alt="image-20220222121036160">
<figcaption aria-hidden="true">image-20220222121036160</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121132181.png" alt="image-20220222121132181">
<figcaption aria-hidden="true">image-20220222121132181</figcaption>
</figure>
<h3 id="在rancher-web界面添加kubernetes集群">10.3 在rancher
web界面添加kubernetes集群</h3>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121419801.png" alt="image-20220222121419801">
<figcaption aria-hidden="true">image-20220222121419801</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121500369.png" alt="image-20220222121500369">
<figcaption aria-hidden="true">image-20220222121500369</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121639207.png" alt="image-20220222121639207">
<figcaption aria-hidden="true">image-20220222121639207</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222121800708.png" alt="image-20220222121800708">
<figcaption aria-hidden="true">image-20220222121800708</figcaption>
</figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用第一条报错：</span><br><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># kubectl apply -f https://192.168.10.10/v3/import/vljtg5srnznpzts662q6ncs4jm6f8kd847xqs97d6fbs5rhn7kfzvk_c-ktwhn.yaml</span></span><br><span class="line">Unable to connect to the server: x509: certificate is valid <span class="keyword">for</span> <span class="number">127.0</span>.<span class="number">0.1</span>, <span class="number">172.17</span>.<span class="number">0.2</span>, not <span class="number">192.168</span>.<span class="number">10.10</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">使用第二条：</span><br><span class="line"></span><br><span class="line">第一次报错：</span><br><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># curl --insecure -sfL https://192.168.10.10/v3/import/vljtg5srnznpzts662q6ncs4jm6f8kd847xqs97d6fbs5rhn7kfzvk_c-ktwhn.yaml | kubectl apply -f -</span></span><br><span class="line">error: no objects passed to apply</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">第二次成功：</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">master01</span> ~]<span class="comment"># curl --insecure -sfL https://192.168.10.10/v3/import/vljtg5srnznpzts662q6ncs4jm6f8kd847xqs97d6fbs5rhn7kfzvk_c-ktwhn.yaml | kubectl apply -f -</span></span><br><span class="line">Warning: resource clusterroles/proxy<span class="literal">-clusterrole-kubeapiserver</span> is missing the kubectl.kubernetes.io/last<span class="literal">-applied-configuration</span> annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create <span class="literal">--save-config</span> or kubectl apply. The missing annotation will be patched automatically.</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/proxy<span class="literal">-clusterrole-kubeapiserver</span> configured</span><br><span class="line">Warning: resource clusterrolebindings/proxy<span class="literal">-role-binding-kubernetes-master</span> is missing the kubectl.kubernetes.io/last<span class="literal">-applied-configuration</span> annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create <span class="literal">--save-config</span> or kubectl apply. The missing annotation will be patched automatically.</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/proxy<span class="literal">-role-binding-kubernetes-master</span> configured</span><br><span class="line">namespace/cattle<span class="literal">-system</span> created</span><br><span class="line">serviceaccount/cattle created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/cattle<span class="literal">-admin-binding</span> created</span><br><span class="line">secret/cattle<span class="literal">-credentials-0619853</span> created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/cattle<span class="literal">-admin</span> created</span><br><span class="line">Warning: spec.template.spec.affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms[<span class="number">0</span>].matchExpressions[<span class="number">0</span>].key: beta.kubernetes.io/os is deprecated since v1.<span class="number">14</span>; use <span class="string">&quot;kubernetes.io/os&quot;</span> instead</span><br><span class="line">deployment.apps/cattle<span class="literal">-cluster-agent</span> created</span><br></pre></td></tr></table></figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222124826542.png" alt="image-20220222124826542">
<figcaption aria-hidden="true">image-20220222124826542</figcaption>
</figure>
<figure>
<img src="/2023/05/10/%E6%95%B0%E6%8D%AE%E5%BA%93/graphdatabase/k8s%E9%83%A8%E7%BD%B2nebulaGraph//image-20220222124844668.png" alt="image-20220222124844668">
<figcaption aria-hidden="true">image-20220222124844668</figcaption>
</figure>
<ul>
<li><p>查看pod运行在那个节点</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看podid</span></span><br><span class="line">kubectl get pods <span class="literal">-o</span> wide</span><br><span class="line"><span class="comment">#进入pod</span></span><br><span class="line">kubectl exec <span class="literal">-it</span> containerid  <span class="literal">--</span> /bin/sh</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="十一搭建nfs服务器">十一，搭建nfs服务器</h2>
<ul>
<li><p>```powershell [root@nfsserver ~]# mkdir -p /data/nfs
[root@nfsserver ~]# vim /etc/exports /data/nfs *(rw,no_root_squash,sync)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 所有节点中安装nfs客户端</span><br><span class="line"></span><br><span class="line">  ```powershell</span><br><span class="line">  yum install nfs-utils -y</span><br></pre></td></tr></table></figure></p></li>
<li><p>验证是否可用再工作节点中</p></li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">showmount <span class="literal">-e</span> <span class="number">192.168</span>.<span class="number">222.143</span> <span class="comment">#nfs服务器的地址</span></span><br></pre></td></tr></table></figure>
<h2 id="十二-使用nfs文件系统创建存储动态供给storageclass安装">十二
使用NFS文件系统创建存储动态供给(storageclass安装)</h2>
<p>PV对存储系统的支持可通过其插件来实现，目前，Kubernetes支持如下类型的插件。</p>
<p>PV对存储系统的支持可通过其插件来实现，目前，Kubernetes支持如下类型的插件。</p>
<p>官方地址：https://kubernetes.io/docs/concepts/storage/storage-classes/</p>
<p>官方插件是不支持NFS动态供给的，但是我们可以用第三方的插件来实现</p>
<p>第三方插件地址:
https://github.com/kubernetes-retired/external-storage</p>
<h3 id="下载并创建storageclass">12.1，下载并创建storageclass</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># wget https://raw.githubusercontent.com/kubernetes-sigs/nfs-subdir-external-provisioner/master/deploy/class.yaml</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># mv class.yaml storageclass-nfs.yml</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># cat storageclass-nfs.yml</span></span><br><span class="line">apiVersion: storage.k8s.io/v1</span><br><span class="line">kind: StorageClass				<span class="comment"># 类型</span></span><br><span class="line">metadata:</span><br><span class="line">  name: nfs<span class="literal">-client</span>		<span class="comment"># 名称,要使用就需要调用此名称</span></span><br><span class="line">provisioner: k8s<span class="literal">-sigs</span>.io/nfs<span class="literal">-subdir-external-provisioner</span> 	<span class="comment"># 动态供给插件</span></span><br><span class="line">parameters:</span><br><span class="line">  archiveOnDelete: <span class="string">&quot;false&quot;</span>		<span class="comment"># 删除数据时是否存档，false表示不存档，true表示存档</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># kubectl apply -f storageclass-nfs.yml</span></span><br><span class="line">storageclass.storage.k8s.io/managed<span class="literal">-nfs-storage</span> created</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># kubectl get storageclass</span></span><br><span class="line">NAME         PROVISIONER                                   RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE</span><br><span class="line">nfs<span class="literal">-client</span>   k8s<span class="literal">-sigs</span>.io/nfs<span class="literal">-subdir-external-provisioner</span>   Delete          Immediate           false                  <span class="number">10</span>s</span><br><span class="line"></span><br><span class="line"><span class="comment"># RECLAIMPOLICY pv回收策略，pod或pvc被删除后，pv是否删除还是保留。</span></span><br><span class="line"><span class="comment"># VOLUMEBINDINGMODE Immediate 模式下PVC与PV立即绑定，主要是不等待相关Pod调度完成，不关心其运行节点，直接完成绑定。相反的 WaitForFirstConsumer模式下需要等待Pod调度完成后进行PV绑定。</span></span><br><span class="line"><span class="comment"># ALLOWVOLUMEEXPANSION pvc扩容</span></span><br></pre></td></tr></table></figure>
<h3 id="下载并创建rbac">12.2，下载并创建rbac</h3>
<p>因为storage自动创建pv需要经过kube-apiserver，所以需要授权。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># wget https://raw.githubusercontent.com/kubernetes-sigs/nfs-subdir-external-provisioner/master/deploy/rbac.yaml</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># mv rbac.yaml storageclass-nfs-rbac.yaml</span></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># cat storageclass-nfs-rbac.yaml</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">  <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">  namespace: default</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">kind: ClusterRole</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: nfs<span class="literal">-client-provisioner-runner</span></span><br><span class="line">rules:</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;persistentvolumes&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;delete&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;persistentvolumeclaims&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;update&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;storage.k8s.io&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;storageclasses&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>]</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;events&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: run<span class="literal">-nfs-client-provisioner</span></span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">    <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">    namespace: default</span><br><span class="line">roleRef:</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: nfs<span class="literal">-client-provisioner-runner</span></span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">kind: Role</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: leader<span class="literal">-locking-nfs-client-provisioner</span></span><br><span class="line">  <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">  namespace: default</span><br><span class="line">rules:</span><br><span class="line">  - apiGroups: [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    resources: [<span class="string">&quot;endpoints&quot;</span>]</span><br><span class="line">    verbs: [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">kind: RoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: leader<span class="literal">-locking-nfs-client-provisioner</span></span><br><span class="line">  <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">  namespace: default</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">    <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">    namespace: default</span><br><span class="line">roleRef:</span><br><span class="line">  kind: Role</span><br><span class="line">  name: leader<span class="literal">-locking-nfs-client-provisioner</span></span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># kubectl apply -f rbac.yaml</span></span><br><span class="line">serviceaccount/nfs<span class="literal">-client-provisioner</span> created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/nfs<span class="literal">-client-provisioner-runner</span> created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/run<span class="literal">-nfs-client-provisioner</span> created</span><br><span class="line">role.rbac.authorization.k8s.io/leader<span class="literal">-locking-nfs-client-provisioner</span> created</span><br><span class="line">rolebinding.rbac.authorization.k8s.io/leader<span class="literal">-locking-nfs-client-provisioner</span> created</span><br></pre></td></tr></table></figure>
<h3 id="创建动态供给的deployment">12.3，创建动态供给的deployment</h3>
<p>需要一个deployment来专门实现pv与pvc的自动创建</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># vim deploy-nfs-client-provisioner.yml</span></span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">spec:</span><br><span class="line">  replicas: <span class="number">1</span></span><br><span class="line">  strategy:</span><br><span class="line">    <span class="built_in">type</span>: Recreate</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">    spec:</span><br><span class="line">      serviceAccount: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">      containers:</span><br><span class="line">        - name: nfs<span class="literal">-client-provisioner</span></span><br><span class="line">          image: registry.cn<span class="literal">-beijing</span>.aliyuncs.com/pylixm/nfs<span class="literal">-subdir-external-provisioner</span>:v4.<span class="number">0.0</span></span><br><span class="line">          volumeMounts:</span><br><span class="line">            - name: nfs<span class="literal">-client-root</span></span><br><span class="line">              mountPath: /persistentvolumes</span><br><span class="line">          env:</span><br><span class="line">            - name: PROVISIONER_NAME</span><br><span class="line">              value: k8s<span class="literal">-sigs</span>.io/nfs<span class="literal">-subdir-external-provisioner</span></span><br><span class="line">            - name: NFS_SERVER</span><br><span class="line">              value: <span class="number">192.168</span>.<span class="number">10.129</span></span><br><span class="line">            - name: NFS_PATH</span><br><span class="line">              value: /<span class="keyword">data</span>/nfs</span><br><span class="line">      volumes:</span><br><span class="line">        - name: nfs<span class="literal">-client-root</span></span><br><span class="line">          nfs:</span><br><span class="line">            server: <span class="number">192.168</span>.<span class="number">10.129</span></span><br><span class="line">            path: /<span class="keyword">data</span>/nfs</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># kubectl apply -f deploy-nfs-client-provisioner.yml</span></span><br><span class="line">deployment.apps/nfs<span class="literal">-client-provisioner</span> created</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">k8s</span>-<span class="type">master1</span> ~]<span class="comment"># kubectl get pods |grep nfs-client-provisioner</span></span><br><span class="line">nfs<span class="literal">-client-provisioner-5b5ddcd6c8-b6zbq</span>   <span class="number">1</span>/<span class="number">1</span>     Running   <span class="number">0</span>          <span class="number">34</span>s</span><br></pre></td></tr></table></figure>
<h2 id="十三nebulagraph-operator-安装部署">十三，nebulaGraph operator
安装部署</h2>
<ul>
<li><p>参考官网 安装 NebulaGraph Operator
前，用户需要安装以下软件并确保安装版本的正确性（NebulaGraph Operator
不负责处理安装这些软件过程中出现的问题）。</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">软件</th>
<th style="text-align: left;">版本要求</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a target="_blank" rel="noopener" href="https://kubernetes.io/">Kubernetes</a></td>
<td style="text-align: left;">&gt;= 1.16</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a target="_blank" rel="noopener" href="https://helm.sh/">Helm</a></td>
<td style="text-align: left;">&gt;= 3.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a target="_blank" rel="noopener" href="https://github.com/coredns/coredns">CoreDNS</a></td>
<td style="text-align: left;">&gt;= 1.6.0</td>
</tr>
</tbody>
</table></li>
<li><p>Helm安装</p>
<p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">a</span> ~]<span class="comment"># curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash</span></span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line"><span class="number">100</span> <span class="number">11345</span>  <span class="number">100</span> <span class="number">11345</span>    <span class="number">0</span>     <span class="number">0</span>  <span class="number">18830</span>      <span class="number">0</span> <span class="literal">--</span>:<span class="literal">--</span>:<span class="literal">--</span> <span class="literal">--</span>:<span class="literal">--</span>:<span class="literal">--</span> <span class="literal">--</span>:<span class="literal">--</span>:<span class="literal">--</span> <span class="number">18845</span></span><br><span class="line">[<span class="type">WARNING</span>] Could not find git. It is required <span class="keyword">for</span> plugin installation.</span><br><span class="line">Downloading https://get.helm.sh/helm<span class="literal">-v3</span>.<span class="number">12.1</span><span class="literal">-linux-amd64</span>.tar.gz</span><br><span class="line">Verifying checksum... Done.</span><br><span class="line">Preparing to install helm into /usr/local/bin</span><br><span class="line">helm installed into /usr/local/bin/helm</span><br></pre></td></tr></table></figure></p></li>
<li><p>coreDNS安装可以网上查阅资料(上面rke安装过程中已经安装了coredns)</p></li>
<li><p>安装 NebulaGraph Operator</p></li>
</ul>
<ol type="1">
<li><p>添加 NebulaGraph Operator Helm 仓库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm repo add nebula-operator https://vesoft-inc.github.io/nebula-operator/charts</span><br></pre></td></tr></table></figure></li>
<li><p>拉取最新的 Operator Helm 仓库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm repo update</span><br></pre></td></tr></table></figure>
<p>参考 <a target="_blank" rel="noopener" href="https://helm.sh/docs/helm/helm_repo/">Helm
仓库</a>获取更多<code>helm repo</code>相关信息。</p></li>
<li><p>创建命名空间用于安装 NebulaGraph Operator。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create namespace &lt;namespace_name&gt;</span><br></pre></td></tr></table></figure>
<p>例如，创建operator命名空间。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create namespace operator</span><br></pre></td></tr></table></figure>
<ul>
<li>nebula-operator chart 中的所有资源都会安装在该命名空间下。</li>
<li>用户也可创建其他命名空间。</li>
</ul></li>
<li><p>安装 NebulaGraph Operator。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm install nebula-operator nebula-operator/nebula-operator --namespace=&lt;namespace_name&gt; --version=$&#123;chart_version&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 目前1.5.0无法安装 可以不指定版本 默认安装最新版本,由于gcr.io无法下载镜像使用kubesphere/kube-rbac-proxy:v0.8.0代替</span><br><span class="line"></span><br><span class="line">helm install nebula-operator nebula-operator/nebula-operator --namespace=nebula-operator-system --set image.kubeRBACProxy.image=kubesphere/kube-rbac-proxy:v0.8.0</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><h3 id="卸载-nebulagraph-operator">卸载 NebulaGraph Operator</h3>
<ol type="1">
<li><p>卸载 NebulaGraph Operator chart。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm uninstall nebula-operator --namespace=operator</span><br></pre></td></tr></table></figure></li>
<li><p>删除 CRD。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete crd nebulaclusters.apps.nebula-graph.io</span><br></pre></td></tr></table></figure></li>
</ol></li>
</ul>
<h2 id="十四部署nebulagraphkubectl">十四，部署nebulaGraph（kubectl）</h2>
<ul>
<li>创建集群配置文件。</li>
</ul>
<p>​
创建名为<code>apps_v1alpha1_nebulacluster.yaml</code>的文件。官网提供了模板可以直接下载</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: apps.nebula<span class="literal">-graph</span>.io/v1alpha1</span><br><span class="line">kind: NebulaCluster</span><br><span class="line">metadata:</span><br><span class="line">  name: nebula</span><br><span class="line">spec:</span><br><span class="line">  graphd:</span><br><span class="line">    resources:</span><br><span class="line">      requests:</span><br><span class="line">        cpu: <span class="string">&quot;500m&quot;</span></span><br><span class="line">        memory: <span class="string">&quot;500Mi&quot;</span></span><br><span class="line">      limits:</span><br><span class="line">        cpu: <span class="string">&quot;1&quot;</span></span><br><span class="line">        memory: <span class="string">&quot;1Gi&quot;</span></span><br><span class="line">    replicas: <span class="number">1</span></span><br><span class="line">    image: vesoft/nebula<span class="literal">-graphd</span></span><br><span class="line">    version: v3.<span class="number">5.0</span></span><br><span class="line">    service:</span><br><span class="line">      <span class="built_in">type</span>: NodePort</span><br><span class="line">      externalTrafficPolicy: Local</span><br><span class="line">    logVolumeClaim:</span><br><span class="line">      resources:</span><br><span class="line">        requests:</span><br><span class="line">          storage: <span class="number">1</span><span class="built_in">Gi</span></span><br><span class="line">      storageClassName: managed<span class="literal">-nfs-storage</span></span><br><span class="line">  metad:</span><br><span class="line"><span class="comment">#    license:</span></span><br><span class="line"><span class="comment">#      secretName: &quot;nebula-license&quot;</span></span><br><span class="line"><span class="comment">#      licenseKey: &quot;nebula.license&quot;</span></span><br><span class="line">    resources:</span><br><span class="line">      requests:</span><br><span class="line">        cpu: <span class="string">&quot;500m&quot;</span></span><br><span class="line">        memory: <span class="string">&quot;500Mi&quot;</span></span><br><span class="line">      limits:</span><br><span class="line">        cpu: <span class="string">&quot;1&quot;</span></span><br><span class="line">        memory: <span class="string">&quot;1Gi&quot;</span></span><br><span class="line">    replicas: <span class="number">1</span></span><br><span class="line">    image: vesoft/nebula<span class="literal">-metad</span></span><br><span class="line">    version: v3.<span class="number">5.0</span></span><br><span class="line">    dataVolumeClaim:</span><br><span class="line">      resources:</span><br><span class="line">        requests:</span><br><span class="line">          storage: <span class="number">5</span><span class="built_in">Gi</span></span><br><span class="line">      storageClassName:  managed<span class="literal">-nfs-storage</span></span><br><span class="line">    logVolumeClaim:</span><br><span class="line">      resources:</span><br><span class="line">        requests:</span><br><span class="line">          storage: <span class="number">1</span><span class="built_in">Gi</span></span><br><span class="line">      storageClassName:  managed<span class="literal">-nfs-storage</span></span><br><span class="line">  storaged:</span><br><span class="line">    resources:</span><br><span class="line">      requests:</span><br><span class="line">        cpu: <span class="string">&quot;500m&quot;</span></span><br><span class="line">        memory: <span class="string">&quot;500Mi&quot;</span></span><br><span class="line">      limits:</span><br><span class="line">        cpu: <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：所有的storageClassName需要和上面安装storageclass时名称相同。 即
storageclass-nfs.yml中的 metadata.name: nfs-client</p>
</blockquote>
<ul>
<li><p>查看状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nebula-exporter-66457984-w6zpn            1/1     Running   0          31m</span><br><span class="line">nebula-graphd-0                           2/2     Running   0          31m</span><br><span class="line">nebula-metad-0                            2/2     Running   0          35m</span><br><span class="line">nebula-storaged-0                         2/2     Running   0          35m</span><br><span class="line">nebula-storaged-1                         0/2     Pending   0          35m</span><br><span class="line">nebula-storaged-2                         0/2     Pending   0          35m</span><br><span class="line">nfs-client-provisioner-6bd7f48698-m4v94   1/1     Running   0          57m</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="十五连接nebula">十五，连接nebula</h2>
<ul>
<li><p>按照官网提供的模板修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    # modify the cluster name</span><br><span class="line">    app.kubernetes.io/cluster: &quot;nebula&quot;</span><br><span class="line">    app.kubernetes.io/component: graphd</span><br><span class="line">    app.kubernetes.io/managed-by: nebula-operator</span><br><span class="line">    app.kubernetes.io/name: nebula-graph</span><br><span class="line">  name: nebula-graphd-nodeport-svc</span><br><span class="line">  namespace: default</span><br><span class="line">spec:</span><br><span class="line">  externalTrafficPolicy: Cluster #改为local，无法连接到数据库，这里改为Cluster</span><br><span class="line">  ports:</span><br><span class="line">  - name: thrift</span><br><span class="line">    port: 9669</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: 9669</span><br><span class="line">  - name: http</span><br><span class="line">    port: 19669</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: 19669</span><br><span class="line">  selector:</span><br><span class="line">    # modify the cluster name</span><br><span class="line">    app.kubernetes.io/cluster: &quot;nebula&quot;</span><br><span class="line">    app.kubernetes.io/component: graphd</span><br><span class="line">    app.kubernetes.io/managed-by: nebula-operator</span><br><span class="line">    app.kubernetes.io/name: nebula-graph</span><br><span class="line">  type: NodePort</span><br></pre></td></tr></table></figure></li>
<li><p>执行以下命令使 Service 服务在集群中生效。</p></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create -f graphd-nodeport-service.yaml</span><br></pre></td></tr></table></figure>
<ul>
<li>查看 Service 中NebulaGraph映射至集群节点的端口。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get services -l app.kubernetes.io/cluster=&lt;nebula&gt;  #&lt;nebula&gt;为变量值，请用实际集群名称替换。</span><br></pre></td></tr></table></figure>
<ul>
<li>返回：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME                           TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                                          AGE</span><br><span class="line">nebula-graphd-svc-nodeport     NodePort    10.107.153.129 &lt;none&gt;        9669:32236/TCP,19669:31674/TCP,19670:31057/TCP   24h</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><code>NodePort</code>类型的 Service
中，映射至集群节点的端口为<code>32236</code>。</p>
<ol type="1">
<li><p>使用节点 IP 和上述映射的节点端口连接 NebulaGraph。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl run -ti --image vesoft/nebula-console:v3.5.0 --restart=Never -- &lt;nebula_console_name&gt; -addr &lt;node_ip&gt; -port &lt;node_port&gt; -u &lt;username&gt; -p &lt;password&gt;</span><br></pre></td></tr></table></figure>
<p>示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl run -ti --image vesoft/nebula-console:v3.5.0 --restart=Never -- nebula-console -addr 192.168.8.24 -port 32236 -u root -p vesoft</span><br><span class="line">If you don&#x27;t see a command prompt, try pressing enter.</span><br><span class="line"></span><br><span class="line">(root@nebula) [(none)]&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>--image</code>：为连接NebulaGraph的工具 NebulaGraph Console
的镜像。</li>
<li><code>&lt;nebula-console&gt;</code>：自定义的 Pod
名称。本示例为<code>nebula-console</code>。</li>
<li><code>-addr</code>：NebulaGraph集群中任一节点 IP
地址。本示例为<code>192.168.8.24</code>。</li>
<li><code>-port</code>：NebulaGraph映射至节点的端口。本示例为<code>32236</code>。</li>
<li><code>-u</code>：NebulaGraph账号的用户名。未启用身份认证时，可以使用任意已存在的用户名（默认为
root）。</li>
<li><code>-p</code>：用户名对应的密码。未启用身份认证时，密码可以填写任意字符。</li>
</ul></li>
</ol>
</div><div class="article-licensing box"><div class="licensing-title"><p>k8s安装部署nebulaGraph</p><p><a href="https://0914ds.github.io/2023/05/10/数据库/graphdatabase/k8s部署nebulaGraph/">https://0914ds.github.io/2023/05/10/数据库/graphdatabase/k8s部署nebulaGraph/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>albert dong</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-05-10</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-06-22</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="../../../../../../" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="../../../../../../" alt="Alipay"></span></a><a class="button donate" href="../../../../../../" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="../../../../../../" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="../../../../../../" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="../../mysql/mysql%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">mysql执行计划</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="../%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93nebulaGraph%E9%80%89%E5%9E%8B/"><span class="level-item">图数据库nebulaGraph选型</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="../../../../../../img/avatar.png" alt="albert"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">albert</p><p class="is-size-6 is-block">albert</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>shanghai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="../../../../../../archives"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="../../../../../../categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="../../../../../../tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/0914ds" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="../../../../../../index.html"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#k8s集群安装nebulagraph部署"><span class="level-left"><span class="level-item">1</span><span class="level-item">k8s集群安装&amp;nebulaGraph部署</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#一集群环境准备"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">一，集群环境准备</span></span></a></li><li><a class="level is-mobile" href="#二docker部署"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">二、Docker部署</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#配置docker-yum源"><span class="level-left"><span class="level-item">1.2.1</span><span class="level-item">2.1 配置Docker YUM源</span></span></a></li><li><a class="level is-mobile" href="#安装docker-ce"><span class="level-left"><span class="level-item">1.2.2</span><span class="level-item">2.2 安装Docker CE</span></span></a></li><li><a class="level is-mobile" href="#启动docker服务"><span class="level-left"><span class="level-item">1.2.3</span><span class="level-item">2.3 启动Docker服务</span></span></a></li><li><a class="level is-mobile" href="#配置docker容器镜像加速器"><span class="level-left"><span class="level-item">1.2.4</span><span class="level-item">2.4 配置Docker容器镜像加速器</span></span></a></li></ul></li><li><a class="level is-mobile" href="#三docker-compose安装"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">三、docker compose安装</span></span></a></li><li><a class="level is-mobile" href="#四添加rancher用户"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">四、添加rancher用户</span></span></a></li><li><a class="level is-mobile" href="#五生成ssh证书用于部署集群"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">五、生成ssh证书用于部署集群</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#生成ssh证书"><span class="level-left"><span class="level-item">1.5.1</span><span class="level-item">5.1 生成ssh证书</span></span></a></li><li><a class="level is-mobile" href="#复制证书到集群中所有主机"><span class="level-left"><span class="level-item">1.5.2</span><span class="level-item">5.2 复制证书到集群中所有主机</span></span></a></li><li><a class="level is-mobile" href="#验证ssh证书是否可用"><span class="level-left"><span class="level-item">1.5.3</span><span class="level-item">5.3 验证ssh证书是否可用</span></span></a></li></ul></li><li><a class="level is-mobile" href="#六rke工具下载"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">六、rke工具下载</span></span></a></li><li><a class="level is-mobile" href="#七初始化rke配置文件"><span class="level-left"><span class="level-item">1.7</span><span class="level-item">七、初始化rke配置文件</span></span></a></li><li><a class="level is-mobile" href="#八集群部署"><span class="level-left"><span class="level-item">1.8</span><span class="level-item">八、集群部署</span></span></a></li><li><a class="level is-mobile" href="#九安装kubectl客户端"><span class="level-left"><span class="level-item">1.9</span><span class="level-item">九、安装kubectl客户端</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#kubectl客户端安装"><span class="level-left"><span class="level-item">1.9.1</span><span class="level-item">9.1 kubectl客户端安装</span></span></a></li><li><a class="level is-mobile" href="#kubectl客户端配置集群管理文件及应用验证"><span class="level-left"><span class="level-item">1.9.2</span><span class="level-item">9.2
kubectl客户端配置集群管理文件及应用验证</span></span></a></li></ul></li><li><a class="level is-mobile" href="#十集群web管理-rancher"><span class="level-left"><span class="level-item">1.10</span><span class="level-item">十、集群web管理 rancher</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#使用docker-run启动一个rancher"><span class="level-left"><span class="level-item">1.10.1</span><span class="level-item">10.1，使用docker
run启动一个rancher</span></span></a></li><li><a class="level is-mobile" href="#访问rancher这里映射端口10801443"><span class="level-left"><span class="level-item">1.10.2</span><span class="level-item">10.2
访问rancher【这里映射端口1080，1443】</span></span></a></li><li><a class="level is-mobile" href="#在rancher-web界面添加kubernetes集群"><span class="level-left"><span class="level-item">1.10.3</span><span class="level-item">10.3 在rancher
web界面添加kubernetes集群</span></span></a></li></ul></li><li><a class="level is-mobile" href="#十一搭建nfs服务器"><span class="level-left"><span class="level-item">1.11</span><span class="level-item">十一，搭建nfs服务器</span></span></a></li><li><a class="level is-mobile" href="#十二-使用nfs文件系统创建存储动态供给storageclass安装"><span class="level-left"><span class="level-item">1.12</span><span class="level-item">十二
使用NFS文件系统创建存储动态供给(storageclass安装)</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#下载并创建storageclass"><span class="level-left"><span class="level-item">1.12.1</span><span class="level-item">12.1，下载并创建storageclass</span></span></a></li><li><a class="level is-mobile" href="#下载并创建rbac"><span class="level-left"><span class="level-item">1.12.2</span><span class="level-item">12.2，下载并创建rbac</span></span></a></li><li><a class="level is-mobile" href="#创建动态供给的deployment"><span class="level-left"><span class="level-item">1.12.3</span><span class="level-item">12.3，创建动态供给的deployment</span></span></a></li></ul></li><li><a class="level is-mobile" href="#十三nebulagraph-operator-安装部署"><span class="level-left"><span class="level-item">1.13</span><span class="level-item">十三，nebulaGraph operator
安装部署</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#卸载-nebulagraph-operator"><span class="level-left"><span class="level-item">1.13.1</span><span class="level-item">卸载 NebulaGraph Operator</span></span></a></li></ul></li><li><a class="level is-mobile" href="#十四部署nebulagraphkubectl"><span class="level-left"><span class="level-item">1.14</span><span class="level-item">十四，部署nebulaGraph（kubectl）</span></span></a></li><li><a class="level is-mobile" href="#十五连接nebula"><span class="level-left"><span class="level-item">1.15</span><span class="level-item">十五，连接nebula</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="../../../../../../js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="../../../../../../categories/JVM%E8%B0%83%E4%BC%98%E5%90%88%E9%9B%86/"><span class="level-start"><span class="level-item">JVM调优合集</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/%E5%AE%B9%E5%99%A8/"><span class="level-start"><span class="level-item">容器</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="level-start"><span class="level-item">数据库</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">机器学习</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/"><span class="level-start"><span class="level-item">消息中间件</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-17T17:13:16.000Z">2023-08-18</time></p><p class="title"><a href="../../../../../08/18/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D/">多元线性回归</a></p><p class="categories"><a href="../../../../../../categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-17T05:13:16.000Z">2023-08-17</time></p><p class="title"><a href="../../../../../08/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">多元线性回归</a></p><p class="categories"><a href="../../../../../../categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-16T17:30:16.000Z">2023-08-17</time></p><p class="title"><a href="../../../../../08/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/3-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E4%BC%98%E5%8C%96/">梯度下降优化</a></p><p class="categories"><a href="../../../../../../categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-17T06:13:16.000Z">2023-06-17</time></p><p class="title"><a href="../../../../../06/17/%E6%B6%88%E6%81%AF/kafka/">kafka</a></p><p class="categories"><a href="../../../../../../categories/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/">消息中间件</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-05T07:02:29.235Z">2023-06-05</time></p><p class="title"><a href="../../../../../06/05/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E7%9A%84%E9%94%81%E6%9C%BA%E5%88%B6/">mysql的锁机制</a></p><p class="categories"><a href="../../../../../../categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="../../../../../../archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="../../../../../../index.html"><img src="../../../../../../img/logo.svg" alt="blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 albert dong</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="../../../../../../js/column.js"></script><script src="../../../../../../js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="../../../../../../js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="../../../../../../js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="../../../../../../js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"../../../../../../content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>